rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // Hardened baseline:
    // - Deny all direct Firebase client SDK access.
    // - Allow access only through backend-managed service-account writes
    //   and short-lived signed URLs generated by the backend.
    //
    // Note: Admin SDK / service-account operations are not restricted by these rules.
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
